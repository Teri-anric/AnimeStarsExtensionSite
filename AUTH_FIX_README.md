# Виправлення авторизації - Token Expiration Handling

## Проблема
Коли JWT токен закінчувався, фронтенд не помічав цього і продовжував працювати з недійсним токеном, що призводило до помилок 401 без автоматичного перенаправлення на сторінку входу.

## Рішення

### 1. Створено Auth Interceptor (`frontend/src/utils/authInterceptor.ts`)
- **Axios Request Interceptor**: Автоматично додає токен до всіх HTTP запитів
- **Axios Response Interceptor**: Перехоплює 401 помилки і автоматично:
  - Очищає localStorage
  - Викликає функцію logout
  - Перенаправляє на `/login`

### 2. Оновлено AuthContext (`frontend/src/context/AuthContext.tsx`)
- Додано перевірку валідності токена при ініціалізації
- Інтегровано з auth interceptor
- Автоматична очистка недійсних токенів

### 3. Інтеграція
- Interceptor налаштовується автоматично при імпорті `apiClient.ts`
- Додано імпорт в `main.tsx` для гарантії налаштування

## Як це працює

1. **При завантаженні додатку**: Перевіряється валідність збереженого токена
2. **При кожному API запиті**: Автоматично додається токен до заголовків
3. **При отриманні 401 помилки**: Автоматично виконується logout і перенаправлення
4. **При недійсному токені**: Користувач автоматично перенаправляється на сторінку входу

## Файли, що були змінені

- `frontend/src/utils/authInterceptor.ts` - новий файл
- `frontend/src/context/AuthContext.tsx` - оновлено
- `frontend/src/utils/apiClient.ts` - додано інтеграцію
- `frontend/src/main.tsx` - додано імпорт
- `frontend/src/utils/testAuth.ts` - тестовий файл

## Переваги

✅ Автоматичне виявлення expired токенів  
✅ Автоматичне перенаправлення на login  
✅ Централізована обробка помилок авторизації  
✅ Покращений UX - користувач не залишається з недійсним токеном  
✅ Мінімальні зміни в існуючому коді  

## Тестування

1. Зайдіть в додаток
2. Дочекайтеся закінчення токена (або змініть час в backend)
3. Спробуйте виконати будь-яку дію
4. Має відбутися автоматичне перенаправлення на `/login`